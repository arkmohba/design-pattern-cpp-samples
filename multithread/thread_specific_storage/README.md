# 概要

Thread-Specific Storageパターンを実装してみたもの。

* 関数内のstatic変数はそのままではスレッド間共有になってしまうので、分けたい場合はthread_localにする。
* 関数内で閉じる変数はそもそもスレッドセーフなので、何も考えず使ってよい。
* スレッドローカルはスレッドの外にまとめて置かれている。
  * コーディングは簡単になるが、ソースが理解しにくくなる危険性がある。
* スレッド内の局所変数などにする場合スレッド内にスレッド固有の情報を置いていることになる。
* スレッドローカルな変数は他のスレッドからアクセスされる心配がない
  * 今回、排他制御は特にしていない。
* スループットが上がるとは限らない
  * スレッドローカルのスレッド判定部分は排他制御をしている可能性がある。
  * プログラムの構造を変えずに済む点、排他制御が表に出ないのでロジックエラーが減らせる点が主眼
* スレッドローカルな変数にはスレッドに関する情報を引数では渡していない。
  * コンテキストを導入している事になり、データの流れがわかりづらく、バグの危険性が高まる。
* アクターベースとタスクベースのアプローチが存在する


# 所感

* スレッドローカルストレージについてはthread_local修飾子をつけると確保できる。
* スレッド名をつけるため、クラス変数として__nameを用意して、スレッドローカルにしたら動いた。
